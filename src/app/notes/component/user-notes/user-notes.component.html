<h2>Notes ของผู้ใช้ {{ userName }} ({{ '#' + userId }})</h2>
<h2>Notes test {{ apiUrl }}</h2>

<div *ngIf="loading">กำลังโหลด...</div>
<div *ngIf="error">{{ error }}</div>

<div *ngIf="!loading && !error && notes.length === 0">ไม่มีโน้ตของผู้ใช้นี้</div>

<div *ngFor="let n of notes; trackBy: trackById">
  <ng-container *ngIf="n.note as note">
    <div><strong>Title:</strong> {{ note.title }}</div>
    <div>
      <strong>Status:</strong>
      <span style="margin-right: 8px;">{{ note.status }}</span>
      <button type="button" (click)="updateStatus(note, 'open')" [disabled]="note.status === 'open'">open</button>
      <button type="button" (click)="updateStatus(note, 'in_progress')" [disabled]="note.status === 'in_progress'">in_progress</button>
      <button type="button" (click)="updateStatus(note, 'done')" [disabled]="note.status === 'done'">done</button>
    </div>
    <div><strong>Product ID:</strong> {{ note.product_id ?? '-' }}</div>
    <div><strong>Created:</strong> {{ note.created_at }}</div>
    <div><strong>Updated:</strong> {{ note.updated_at }}</div>
    <div *ngIf="note.body"><strong>Body:</strong> {{ note.body }}</div>
  </ng-container>
  <ng-container *ngIf="n.product as product; else noProduct">
    <div><strong>Product:</strong> {{ product.name ?? '-' }}</div>
    <div><strong>SKU:</strong> {{ product.sku ?? '-' }}</div>
    <div><strong>Price:</strong> {{ product.price ?? '-' }}</div>
  </ng-container>
  <ng-template #noProduct>
    <div><strong>Product:</strong> -</div>
    <div><strong>SKU:</strong> -</div>
    <div><strong>Price:</strong> -</div>
  </ng-template>
  <hr />
</div>

<div style="margin-top: 12px;">
  <a [routerLink]="['/users']">กลับไปหน้าผู้ใช้</a>
</div>